<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ page.title | default: site.title }}</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <style>
    :root {
      --bg: #f8f9fa;
      --text: #222;
      --panel-bg: #fff;
      --panel-border: #ddd;
      --sidebar-bg: #222;
      --sidebar-text: #eee;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #181a1b;
        --text: #eee;
        --panel-bg: #23272b;
        --panel-border: #444;
        --sidebar-bg: #181a1b;
        --sidebar-text: #eee;
      }
    }
    body { background: var(--bg); color: var(--text); }
    .panel { background: var(--panel-bg); border-color: var(--panel-border); }
    .sidebar { background: var(--sidebar-bg) !important; color: var(--sidebar-text); }
    .sidebar a { color: var(--sidebar-text) !important; }
    .center-logo {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 60vh;
    }
    .center-logo img {
      max-width: 180px;
      margin-bottom: 24px;
    }
    .center-logo h1 {
      font-size: 2.2em;
      font-weight: 600;
      color: var(--text);
    }
    .center-logo p {
      color: #888;
      font-size: 1.2em;
    }
    @media (max-width: 600px) {
      .center-logo h1 { font-size: 1.3em; }
    }
    /* Toggle button */
    .theme-toggle {
      position: fixed;
      top: 10px;
      right: 20px;
      z-index: 2001;
      background: var(--panel-bg);
      color: var(--text);
      border: 1px solid var(--panel-border);
      border-radius: 20px;
      padding: 6px 18px;
      font-size: 15px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: background 0.2s, color 0.2s;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark/light mode">
    <span id="theme-icon" class="material-icons">dark_mode</span>
  </button>
  {% include topbar.html %}
  {% include sidebar.html %}
  <div class="container" style="margin-left:230px;">
    {{ content }}
  </div>
  <script>
    // Theme toggle logic with Material icon
    function setTheme(mode) {
      if (mode === 'dark') {
        document.documentElement.classList.add('dark-mode');
        localStorage.setItem('theme', 'dark');
        setThemeIcon('dark');
      } else {
        document.documentElement.classList.remove('dark-mode');
        localStorage.setItem('theme', 'light');
        setThemeIcon('light');
      }
    }
    function setThemeIcon(mode) {
      var icon = document.getElementById('theme-icon');
      if (!icon) return;
      icon.textContent = (mode === 'dark') ? 'light_mode' : 'dark_mode';
    }
    function toggleTheme() {
      const isDark = document.documentElement.classList.toggle('dark-mode');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      setThemeIcon(isDark ? 'dark' : 'light');
    }
    // On load, set theme from localStorage or system
    (function() {
      const saved = localStorage.getItem('theme');
      if (saved === 'dark') {
        document.documentElement.classList.add('dark-mode');
        setThemeIcon('dark');
      } else if (saved === 'light') {
        document.documentElement.classList.remove('dark-mode');
        setThemeIcon('light');
      } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.classList.add('dark-mode');
        setThemeIcon('dark');
      } else {
        setThemeIcon('light');
      }
    })();
  </script>
  {% include bottombar.html %}
</body>
</html>
